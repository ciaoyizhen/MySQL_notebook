# 第3章 MySQL数据类型

## 数值类型

### 整数类型

#### 二进制

​	在使用二进制表示整数时，有两种解释。

一位二进制的情况：

1. **无符号数(仅代表非负数)**：符号0代表数字0，符号1代表数字1，其取值范围为$0\sim1$，即$0\sim2^1-1$。
1. **有符号数(代表正数和负数都行)**：符号0代表数字0，符号1代表数字-1，其取值范围$-1\sim 0$，即$-2^0\sim2^0-1$。

n位二进制的情况：

1. 无符号数的范围就是$0\sim2^n-1$。
2. 有符号数的范围就是$-2^{n-1}\sim2^{n-1}-1$。

由于1个二进制能传递的信息实在是太少了，所以计算机中一般以8个二进制作为分配存储空间的基本单位，8个二进制位也被称为一个字节。

#### 整数的类型以及占用的空间和含义

| 类型      | 占用的存储空间 | 无符号数取值范围              | 有符号数取值范围                           | 含义           |
| --------- | -------------- | ----------------------------- | ------------------------------------------ | -------------- |
| TINYINT   | 1字节          | $0\sim 2^8-1(0\sim 255)$      | $-2^7\sim2^7-1(-128\sim127)$               | 非常小的整数   |
| SMALLINT  | 2字节          | $0\sim2^{16}-1(0\sim65535)$   | $-2^{15}\sim2^{15}-1(-32768\sim32767)$     | 小的整数       |
| MEDIUMINT | 3字节          | $0\sim2^{24}-1(0\sim1677215)$ | $-2^{23}\sim2^{23}-1(-8388608\sim8388607)$ | 中等大小的整数 |
| INT       | 4字节          | $0\sim2^{32}-1$               | …                                          | 标准的整数     |
| BIGINT    | 8字节          | $0\sim2^{64}-1$               | …                                          | 大整数         |

如何使用？

在数据类型后面加上UNSIGNED单词，则表示该类型表示无符号数。比方说TINYINT UNSINGNED就表示无符号数；而有符号数则在后面添加SIGNED或者不加默认使用符号数。

> 注意：无符号数只用在整型中。

### 浮点数类型

浮点数是用来表示消暑的。

| 类型   | 占用的存储空间 | 绝对值最小非0值                     | 绝对值最大值                       | 含义         |
| ------ | -------------- | ----------------------------------- | ---------------------------------- | ------------ |
| FLOAT  | 4字节          | $\pm1.175494351\text{E}-38$         | $\pm3.4002823466\text{E}+38$       | 单精度浮点数 |
| DOUBLE | 8字节          | $\pm2.2250738585072014\text{E}-308$ | $\pm1.797693148623157\text{E}+308$ | 双精度浮点数 |

需要注意的是，虽然有的十进制小数容易转换成二进制数去表示，但大部分的数是无法直接转换成二进制的，但是我们现在使用4个字节或者8个字节来表示这个数，必须进行一些舍入来近似表示。因此，**使用浮点数表示小数是不精确的**。

在定义浮点型类型时，还可以在FLOAT 或者DOUBEL后面跟上两个参数，如：

FLOAT(M, D)       DOUBLE(M, D)

用户使用的都是十进制的小数，如果事先知道表中某列要存储的小数在一定范围内，就可以使用FLOAT(M, D)或者DOUBLE(M, D)来限制可以存储到本列中的小数范围。

其中M表示该小数最多包含的有效数字的个数。N表示该小数保留小数点后十进制的个数。举例说明如下：

| 类型        | 取值范围          |
| ----------- | ----------------- |
| FLOAT(4, 1) | $-999.9\sim999.9$ |
| FLOAT(4, 2) | $-99.99\sim99.99$ |

> 注意：修改M、D的值并不会修改占用的存储空间，并且MySQL8.0之后不再推荐使用M、D了。直接使用FLOAT或者DOUBLE即可。

### 定点数类型

定点数也是存储小数的一种方式，与浮点数不同，定点数保证所存储的小数是精确的。

DECIMAL(M, D)占用的字节数与取值范围取决于M和D的取值。原理是，他在存储时，将小数点前的数和小数点后的数分别进行存储，如此就可以用两个十进制的方式存储一个精确的小数。

使用DECIMAL数据类型的列需要占用多少存储空间呢？

从整数类型可以看到，有符号数的int类型使用$-2^{31}\sim2^{31}-1$的范围，处于$-2147483648\sim2147483447$的范围，可以涵盖所有的九位数$-9999999999\sim999999999$的取值。因此，先将小数点前后分为两组，然后每九个为一组，然后每个都组进行分别存储。例如，DEMCIMAL(16,  4)来说，其分为三组，第一组为3个数，第二组为9个数，第三组为4个数。每组所使用的存储空间大小也不相同。

| 组中所包含的十进制的位数 | 占用存储空间大小 |
| ------------------------ | ---------------- |
| 1或2                     | 1字节            |
| 3或4                     | 2字节            |
| 5或6                     | 3字节            |
| 7或8或9                  | 4字节            |

占用空间大小的原理如int一致，对于DEMCIMAL(16, 4)来说，其占用8个字节存储。



## 日期和时间类型

| 类型      | 占用的存储空间 | 取值范围                                      | 含义         |
| --------- | -------------- | --------------------------------------------- | ------------ |
| YEAR      | 1字节          | $1901\sim2155$                                | 年份值       |
| DATE      | 3字节          | ‘1000-01-01’~‘9999-12-31’                     | 日期值       |
| TIME      | 3字节          | ‘-838:59:59’~ ‘838:59:59’                     | 时间值       |
| DATETIME  | 8字节          | ‘1000-01-01 00:00:00’~‘9999-12-31 23:59:59’   | 日期和时间值 |
| TIMESTAMP | 4字节          | ‘1970-01-01 00:00:01’ ~ ‘2038-01-19 03:14:07’ | 时间戳       |

对于TIME、DATETIME、TIMESTAMP三种，MySQL提供了小数秒的支持，但一般用不到，就不记了。

### YEAR

YEAR表示一个年份值，其取值范围有限，但仅占用一个字节，若需要使用更大范围的年份，一般使用SMALLINT(2字节)或者字符串存储。

### DATE、TIME、DATETIME

为了表示方便，我们使用YYYY、MM、DD、hh、mm、ss、uuuuu来分别表示年、月、日、时、分、秒、微秒。

DATE表示日期，格式为YYYY-MM-DD。TIME表示时间，格式为hh:mm:ss[.uuuuu]或者hhh:mm:ss[.uuuuu]。TIME不仅可以表示时间值，还可以表示一段时间，既两个时间的差值，因此，其可能为负值。DATETIME表示日期和时间，格式是YYYY-MM-DD hh:mm:ss[.uuuuu]，与TIME不同的是，DATETIME存储的时间必须是一天内的某个时间(也就是hh必须小于24小时)。

### TIMESTAMP

时间戳的好处是，会自动根据系统存储的时区进行自动更新，若在东八区存储了“2021-04-30 22:02:56”到TIMESTAMP中，若系统时间调整为东九区，则数据就会自动更新成“2021-04-30 23:02:56”。而使用字符串或者其他的格式，时间并不会自动更新。



## 字符串类型

字符是面向人类对象的，字节是面向计算机对象的。

| 类型       | 最大长度         | 存储空间要求       | 含义             |
| ---------- | ---------------- | ------------------ | ---------------- |
| CHAR(M)    | M个字符          | M$\times$W字节     | 固定长度的字符串 |
| VARCHAR(M) | M个字符          | L+1字节或者L+2字节 | 可变长度的字符串 |
| TINYTEXT   | $2^8-1$个字节    | L+1字节            | 非常小型的字符串 |
| TEXT       | $2^{16}-1$个字节 | L+2字节            | 小型的字符串     |
| MEDIUMTEXT | $2^{24}-1$个字节 | L+3字节            | 中等大小的字符串 |
| LONGTEXT   | $2^{32}-1$个字节 | L+4字节            | 大型的字符串     |

其中M代表该数据类型最多能存储的字符数量，L代表实际向该类型的列中存储的字符串在特定字符集下所占的字节数，W代表在特定字符集下编码一个字符最多需要的字节数。

### CHAR(M)

CHAR(M)中的M代表该类型最多可以存储的字符数量。M的取值范围为$0\sim255$。若省略M的值，则默认M=1。若M=0，则是一种特别的类型，它只能存储空字符串‘’或NULL。

若实际存储的字符串在特定字符集编码下占用的字节数不足$M\times W$，那么剩余的那些存储空间会用空字符串补齐。若M较大，而存储的字符串非常短时，会造成较大程度的浪费。这个类型一般用于列中数据长度较为统一时使用。

### VARCHAR(M)

若表中某个列需要存储字符串，而字符串长短不一，使用CHAR(M)会造成较大空间的浪费，这时一般使用VARCHAR(M)。

M的理论上取值范围为$1\sim65535$。这是因为MySQL中规定，一行数据最多使用65535的字节。

### 各种TEXT类型

与VARCHAR(M)不同的是，使用TEXT类型的话，则没有一行占用的存储空间不得超过65535字节的限制。

### ENUM类型和SET类型

ENUM类型为枚举类型，只能选择其中的一个进行填写，单选；而SET类型，是可以从中挑选多个，多选。



## 二进制类型

略(因为图片等一般不使用MySQL进行存储)。





